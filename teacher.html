<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Blaiz'bot - Espace Professeur</title>
    <link rel="stylesheet" href="style.css">
    <script>
        // Redirection vers la page de connexion si acc√®s direct ou refresh
        if (!sessionStorage.getItem('authenticated')) {
            window.location.href = 'index.html';
        }
        sessionStorage.removeItem('authenticated');
    </script>
</head>
<body>
    <div class="admin-wrapper">
        <!-- Sidebar Lat√©rale -->
        <aside class="sidebar"> <!-- Retour au bleu standard -->
            <div class="sidebar-header">
                <h2>Blaiz'bot</h2>
                <p>Espace Professeur</p>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-group">
                    <span>MON ACTIVIT√â</span>
                    <a href="#" class="nav-link active" data-section="dashboard">Tableau de bord</a>
                    <a href="#" class="nav-link" data-section="matieres">Mes Mati√®res</a>
                    <a href="#" class="nav-link" data-section="classes">Mes Classes</a>
                    <a href="#" class="nav-link" data-section="eleves">Mes √âl√®ves</a>
                    <a href="#" class="nav-link" data-section="cours">Mes Cours & Contenus</a>
                    <a href="#" class="nav-link" data-section="attributions">Gestion des Attributions</a>
                    <a href="#" class="nav-link" data-section="planning">Planning & Agenda</a>
                    <a href="#" class="nav-link" data-section="messages">Messagerie <span class="status-pill" style="background: #e74c3c; color: white; padding: 2px 6px; font-size: 0.7rem; margin-left: 5px;">3</span></a>
                </div>
            </nav>
            <div class="sidebar-footer">
                <div style="padding: 10px; font-size: 0.8rem; color: #ecf0f1; border-bottom: 1px solid #34495e; margin-bottom: 10px;">
                    Connect√© en tant que :<br><strong>M. Jean DUPONT</strong>
                </div>
                <a href="index.html" class="btn-logout">D√©connexion</a>
            </div>
        </aside>

        <!-- Zone de Travail Principale -->
        <main class="main-content">
            
            <!-- SECTION : DASHBOARD -->
            <section id="section-dashboard" class="admin-section active">
                <header class="content-header">
                    <div class="header-title">
                        <h1>Tableau de Bord P√©dagogique</h1>
                        <p>Analysez les performances et ajustez votre enseignement en temps r√©el.</p>
                    </div>
                    <div class="header-actions" style="display: flex; gap: 10px;">
                        <select id="dash-filter-classe" class="search-filter" style="width: 150px;" onchange="updateDashboardView()">
                            <option value="all">Toutes les classes</option>
                            <option value="6A">6√®me A</option>
                            <option value="3B">3√®me B</option>
                        </select>
                        <select id="dash-filter-eleve" class="search-filter" style="width: 180px;" onchange="updateDashboardView()">
                            <option value="all">Tous les √©l√®ves</option>
                            <option>Alice MARTIN</option>
                            <option>Thomas DUBOIS</option>
                        </select>
                    </div>
                </header>

                <!-- KPI Principaux -->
                <div class="stats-grid">
                    <div class="stats-card">
                        <h3>Taux de Compr√©hension</h3>
                        <div class="stats-value" id="dash-kpi-comprehension">78%</div>
                        <div class="performance-bar-container">
                            <div class="performance-bar" style="width: 78%; background-color: #2ecc71;"></div>
                        </div>
                        <p>Moyenne sur les quiz IA</p>
                    </div>
                    <div class="stats-card">
                        <h3>Engagement √âl√®ves</h3>
                        <div class="stats-value" id="dash-kpi-engagement">85%</div>
                        <p>√âl√®ves actifs cette semaine</p>
                    </div>
                    <div class="stats-card">
                        <h3>Alertes IA Prioritaires</h3>
                        <div class="stats-value" style="color: #e74c3c;" id="dash-kpi-alerts">4</div>
                        <p>Interventions recommand√©es</p>
                    </div>
                    <div class="stats-card">
                        <h3>Temps Moyen / Cours</h3>
                        <div class="stats-value" id="dash-kpi-time">22 min</div>
                        <p>Par session d'apprentissage</p>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                    <!-- Analyse des Contenus -->
                    <div class="stats-card" style="padding: 20px;">
                        <h3>üìà Performance des Cours</h3>
                        <div style="margin-top: 15px;">
                            <h4 style="color: #27ae60; font-size: 0.9rem;">‚úÖ Les mieux compris</h4>
                            <ul class="stats-list" style="margin-bottom: 20px;">
                                <li style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee;">
                                    <span>Introduction aux Nombres Relatifs</span>
                                    <span style="font-weight: bold; color: #27ae60;">94%</span>
                                </li>
                                <li style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee;">
                                    <span>G√©om√©trie : Les Triangles</span>
                                    <span style="font-weight: bold; color: #27ae60;">88%</span>
                                </li>
                            </ul>

                            <h4 style="color: #e67e22; font-size: 0.9rem;">‚ö†Ô∏è √Ä revoir / Am√©liorer</h4>
                            <ul class="stats-list">
                                <li style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee;">
                                    <div>
                                        <span>Les Fractions : Simplification</span><br>
                                        <small style="color: #7f8c8d;">Point de blocage : Division par le PGCD</small>
                                    </div>
                                    <span style="font-weight: bold; color: #e67e22;">52%</span>
                                </li>
                                <li style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee;">
                                    <div>
                                        <span>Alg√®bre : √âquations 1er degr√©</span><br>
                                        <small style="color: #7f8c8d;">Point de blocage : Changement de signe</small>
                                    </div>
                                    <span style="font-weight: bold; color: #e67e22;">61%</span>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- Recommandations IA pour le Professeur -->
                    <div class="stats-card" style="padding: 20px; border-left: 4px solid #3498db; background: #f0f7ff;">
                        <h3>ü§ñ Assistant P√©dagogique Blaiz'bot</h3>
                        <div style="margin-top: 15px;">
                            <div style="background: white; padding: 12px; border-radius: 8px; margin-bottom: 10px; border: 1px solid #d1e9ff;">
                                <strong>Suggestion de rem√©diation collective :</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px; color: #34495e;">
                                    65% de la classe <strong>6√®me A</strong> √©choue sur la simplification des fractions. 
                                    <br><br>
                                    <strong>Action conseill√©e :</strong> Organisez une session de 15 min sur la recherche de diviseurs communs avant de poursuivre le chapitre.
                                </p>
                                <button class="btn-small" style="background: #3498db; color: white; border: none; margin-top: 5px;">Cr√©er un message de rappel</button>
                            </div>
                            <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #d1e9ff;">
                                <strong>Ajustement de contenu :</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px; color: #34495e;">
                                    Le cours "Alg√®bre" semble trop dense. Les √©l√®ves d√©crochent apr√®s la page 4.
                                    <br><br>
                                    <strong>Action conseill√©e :</strong> Scindez le document en deux parties et ins√©rez un quiz interactif interm√©diaire.
                                </p>
                                <button class="btn-small" style="background: #3498db; color: white; border: none; margin-top: 5px;">Modifier le cours</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="data-table-container" style="margin-top: 20px;">
                    <h3>Derni√®res alertes de progression</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>√âl√®ve</th>
                                <th>Classe</th>
                                <th>Sujet</th>
                                <th>Diagnostic IA</th>
                                <th>Urgence</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="dash-alerts-body">
                            <tr>
                                <td>Thomas DUBOIS</td>
                                <td>6√®me A</td>
                                <td>Fractions</td>
                                <td>Inactivit√© prolong√©e sur le quiz (3 jours)</td>
                                <td><span class="status-pill" style="background: #ffebee; color: #c62828;">Haute</span></td>
                                <td><button class="btn-small" onclick="selectChat('Thomas DUBOIS', 'eleve', 'Les Fractions')">Relancer</button></td>
                            </tr>
                            <tr>
                                <td>Alice MARTIN</td>
                                <td>3√®me B</td>
                                <td>Alg√®bre</td>
                                <td>Erreurs r√©p√©t√©es sur les nombres n√©gatifs</td>
                                <td><span class="status-pill" style="background: #fff3e0; color: #ef6c00;">Moyenne</span></td>
                                <td><button class="btn-small" onclick="openEleveDetails('Alice MARTIN')">Voir d√©tails</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- SECTION : MES MATI√àRES -->
            <section id="section-matieres" class="admin-section">
                <header class="content-header">
                    <div class="header-title">
                        <h1>Mes Mati√®res</h1>
                        <p>Mati√®res que vous enseignez</p>
                    </div>
                </header>
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Mati√®re</th>
                                <th>Nombre de classes</th>
                                <th>Volume horaire hebdo</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Math√©matiques</td>
                                <td>4</td>
                                <td>18h</td>
                                <td><button class="btn-icon">üëÅ</button></td>
                            </tr>
                            <tr>
                                <td>Informatique / IA</td>
                                <td>2</td>
                                <td>4h</td>
                                <td><button class="btn-icon">üëÅ</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- SECTION : MES CLASSES -->
            <section id="section-classes" class="admin-section">
                <header class="content-header">
                    <div class="header-title">
                        <h1>Mes Classes</h1>
                        <p>Groupes d'√©l√®ves sous votre responsabilit√©</p>
                    </div>
                </header>
                <div class="stats-grid">
                    <div class="stats-card">
                        <div class="card-header">
                            <h3>6√®me A</h3>
                            <span class="tag">Maths</span>
                        </div>
                        <p>28 √âl√®ves</p>
                        <p>Moyenne : 13.8/20</p>
                        <div class="performance-bar-container">
                            <div class="performance-bar" style="width: 69%; background-color: #2ecc71;"></div>
                        </div>
                        <button class="btn-primary btn-voir-classe" onclick="openClasseModal('6√®me A')" style="width: 100%; margin-top: 10px;">Voir la classe</button>
                    </div>
                    <div class="stats-card">
                        <div class="card-header">
                            <h3>3√®me B</h3>
                            <span class="tag">Maths</span>
                        </div>
                        <p>24 √âl√®ves</p>
                        <p>Moyenne : 12.5/20</p>
                        <div class="performance-bar-container">
                            <div class="performance-bar" style="width: 62%; background-color: #f1c40f;"></div>
                        </div>
                        <button class="btn-primary btn-voir-classe" onclick="openClasseModal('3√®me B')" style="width: 100%; margin-top: 10px;">Voir la classe</button>
                    </div>
                </div>
            </section>

            <!-- SECTION : MES COURS -->
            <section id="section-cours" class="admin-section">
                <header class="content-header">
                    <div class="header-title">
                        <h1>Mes Cours & Contenus</h1>
                        <p>Organisez vos supports et configurez l'IA</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn-secondary" id="btn-new-folder">üìÅ Nouveau Dossier</button>
                        <button class="btn-secondary" id="btn-create-course">üìù Cr√©er un Cours</button>
                        <button class="btn-primary" id="btn-upload-doc">üì§ Charger un document</button>
                    </div>
                </header>

                <div style="display: flex; gap: 20px; height: calc(100vh - 250px);">
                    <!-- Explorateur de fichiers (Arborescence) -->
                    <div class="stats-card" style="flex: 1; overflow-y: auto; padding: 0; border: 1px solid #ddd;">
                        <div style="padding: 15px; border-bottom: 1px solid #eee; background: #f8f9fa; font-weight: bold; display: flex; justify-content: space-between; align-items: center;">
                            <span>Explorateur de contenus</span>
                            <button class="btn-icon" onclick="refreshTree()" title="Actualiser">üîÑ</button>
                        </div>
                        <div class="tree-view" id="main-tree-view" style="padding: 10px;">
                            <div class="tree-item folder open" data-id="root-maths-6">
                                <span class="tree-toggle">‚ñº</span> üìÅ <strong>Math√©matiques - 6√®me</strong>
                                <div class="tree-children">
                                    <div class="tree-item folder" data-id="chap1-fractions">
                                        <span class="tree-toggle">‚ñ∂</span> üìÅ Chapitre 1 : Fractions
                                        <div class="tree-children" style="display: none;">
                                            <div class="tree-item file active" onclick="selectContent('Les fractions - Intro', 'pdf')">üìÑ Intro.pdf</div>
                                            <div class="tree-item file" onclick="selectContent('Quiz Fractions', 'ia')">üìù Quiz_Niveau1.ia</div>
                                        </div>
                                    </div>
                                    <div class="tree-item file" onclick="selectContent('G√©om√©trie de base', 'pdf')">üìÑ G√©om√©trie_Base.pdf</div>
                                </div>
                            </div>
                            <div class="tree-item folder" data-id="root-maths-3">
                                <span class="tree-toggle">‚ñ∂</span> üìÅ <strong>Math√©matiques - 3√®me</strong>
                                <div class="tree-children" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- D√©tails et Actions -->
                    <div style="flex: 2; display: flex; flex-direction: column; gap: 20px;">
                        <div class="stats-card" id="content-details-panel">
                            <div id="content-loading-overlay" style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.8); z-index: 10; flex-direction: column; align-items: center; justify-content: center; border-radius: 8px;">
                                <div class="spinner" style="width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                                <p style="margin-top: 15px; font-weight: bold; color: #3498db;">L'IA analyse le document...</p>
                            </div>

                            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                                <div>
                                    <h2 id="selected-content-title" style="margin: 0;">Les fractions - Introduction</h2>
                                    <span id="selected-content-type" class="tag" style="background: #e8f5e9; color: #2e7d32;">Type : PDF / Cours</span>
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <button class="btn-icon">‚úèÔ∏è</button>
                                    <button class="btn-icon" style="color: #e74c3c;">üóëÔ∏è</button>
                                </div>
                            </div>

                            <div id="content-preview-box" style="background: #f9f9f9; padding: 15px; border-radius: 6px; border: 1px dashed #ccc; margin-bottom: 20px; min-height: 150px;">
                                <div id="ai-analysis-badge" style="display: inline-block; background: #e1f5fe; color: #0288d1; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; margin-bottom: 10px; font-weight: bold;">
                                    ‚ú® IA : Document index√© et pr√™t pour le tutorat
                                </div>
                                <p style="font-size: 0.9rem; color: #2c3e50; line-height: 1.4;">
                                    <strong>R√©sum√© IA :</strong> Ce document traite des bases des fractions, incluant la d√©finition du num√©rateur et du d√©nominateur, ainsi que la repr√©sentation graphique (cercles et rectangles).
                                </p>
                                <div style="height: 60px; background: white; border: 1px solid #eee; display: flex; align-items: center; justify-content: center; color: #95a5a6; font-size: 0.8rem;">
                                    Aper√ßu visuel du document
                                </div>
                            </div>
                        </div>

                        <div class="stats-card">
                            <h3><span class="ai-badge">Configuration IA pour ce contenu</span></h3>
                            <div class="form-group">
                                <label>Objectif p√©dagogique de l'IA</label>
                                <textarea id="ai-content-goal" style="width: 100%; height: 60px; padding: 10px; border-radius: 4px; border: 1px solid #ddd;" placeholder="Ex: L'IA doit aider l'√©l√®ve √† comprendre le concept de num√©rateur..."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label>Types d'exercices autoris√©s pour l'IA</label>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                                    <label class="checkbox-item">
                                        <input type="checkbox" checked> Quiz (QCM)
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox" checked> Exercices d'application
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox"> √âtude de cas
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox"> R√©solution de probl√®mes
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox"> Analyse de texte
                                    </label>
                                    <label class="checkbox-item">
                                        <input type="checkbox"> D√©fi chronom√©tr√©
                                    </label>
                                </div>
                            </div>

                            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px;">
                                <span style="font-size: 0.8rem; color: #7f8c8d;">Derni√®re mise √† jour : Aujourd'hui</span>
                                <button class="btn-primary" onclick="updateAIConfig()" style="background-color: #3498db;">Mettre √† jour l'IA</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION : GESTION DES ATTRIBUTIONS -->
            <section id="section-attributions" class="admin-section">
                <header class="content-header">
                    <div class="header-title">
                        <h1>Gestion des Attributions</h1>
                        <p>Distribuez vos contenus aux classes ou aux √©l√®ves individuellement</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn-primary" onclick="openNewAttributionModal()">‚ûï Nouvelle Attribution</button>
                    </div>
                </header>

                <div class="stats-grid" style="grid-template-columns: 1fr;">
                    <div class="stats-card">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3>Attributions en cours</h3>
                            <div style="display: flex; gap: 10px;">
                                <select class="filter-select" style="padding: 5px; border-radius: 4px; border: 1px solid #ddd;">
                                    <option>Toutes les classes</option>
                                    <option>6√®me A</option>
                                    <option>3√®me B</option>
                                </select>
                                <input type="text" placeholder="Rechercher un contenu..." style="padding: 5px; border-radius: 4px; border: 1px solid #ddd;">
                            </div>
                        </div>
                        
                        <div class="data-table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Contenu</th>
                                        <th>Cible</th>
                                        <th>Date d'attribution</th>
                                        <th>√âch√©ance</th>
                                        <th>Statut IA</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Les fractions - Intro</strong></td>
                                        <td><span class="tag" style="background: #e3f2fd; color: #1976d2;">Classe : 6√®me A</span></td>
                                        <td>12/12/2025</td>
                                        <td>20/12/2025</td>
                                        <td><span class="status-pill" style="background: #2ecc71;">Actif</span></td>
                                        <td>
                                            <button class="btn-icon" title="Modifier">‚úèÔ∏è</button>
                                            <button class="btn-icon" style="color: #e74c3c;" title="Supprimer">üóëÔ∏è</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>Quiz Fractions</strong></td>
                                        <td><span class="tag" style="background: #f3e5f5; color: #7b1fa2;">√âl√®ve : Alice MARTIN</span></td>
                                        <td>14/12/2025</td>
                                        <td>18/12/2025</td>
                                        <td><span class="status-pill" style="background: #2ecc71;">Actif</span></td>
                                        <td>
                                            <button class="btn-icon" title="Modifier">‚úèÔ∏è</button>
                                            <button class="btn-icon" style="color: #e74c3c;" title="Supprimer">üóëÔ∏è</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>G√©om√©trie de base</strong></td>
                                        <td><span class="tag" style="background: #e3f2fd; color: #1976d2;">Classe : 3√®me B</span></td>
                                        <td>10/12/2025</td>
                                        <td>-</td>
                                        <td><span class="status-pill" style="background: #95a5a6;">Termin√©</span></td>
                                        <td>
                                            <button class="btn-icon" title="Modifier">‚úèÔ∏è</button>
                                            <button class="btn-icon" style="color: #e74c3c;" title="Supprimer">üóëÔ∏è</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION : MES √âL√àVES -->
            <section id="section-eleves" class="admin-section">
                <header class="content-header">
                    <div class="header-title">
                        <h1>Mes √âl√®ves</h1>
                        <p>Suivi individuel et distribution personnalis√©e</p>
                    </div>
                    <div class="filter-bar">
                        <div style="display: flex; gap: 10px;">
                            <select id="filter-eleves-classe" onchange="updateElevesList()">
                                <option value="">S√©lectionner une classe...</option>
                                <option value="6A">6√®me A</option>
                                <option value="3B">3√®me B</option>
                            </select>
                            <select id="filter-eleves-nom">
                                <option value="">S√©lectionner un √©l√®ve...</option>
                                <!-- Rempli dynamiquement par ordre alphab√©tique -->
                                <option>Alice MARTIN</option>
                                <option>Thomas DUBOIS</option>
                                <option>Zoe BERNARD</option>
                            </select>
                        </div>
                        <button class="btn-primary" onclick="openEleveDetails(document.getElementById('filter-eleves-nom').value || 'Alice MARTIN')">Analyser l'√©l√®ve</button>
                    </div>
                </header>
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Nom de l'√©l√®ve</th>
                                <th>Classe</th>
                                <th>Progression Moyenne</th>
                                <th>Derni√®re Interaction IA</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="table-eleves-body">
                            <tr>
                                <td>Alice MARTIN</td>
                                <td>3√®me B</td>
                                <td>
                                    <div class="progress-container"><div class="progress-bar" style="width: 75%;"></div></div>
                                </td>
                                <td>Il y a 2h</td>
                                <td>
                                    <button class="btn-small" onclick="openEleveDetails('Alice MARTIN')">Actions</button>
                                    <button class="btn-icon">üìä</button>
                                </td>
                            </tr>
                            <tr>
                                <td>Thomas DUBOIS</td>
                                <td>6√®me A</td>
                                <td>
                                    <div class="progress-container"><div class="progress-bar" style="width: 40%;"></div></div>
                                </td>
                                <td>Hier</td>
                                <td>
                                    <button class="btn-small" onclick="openEleveDetails('Thomas DUBOIS')">Actions</button>
                                    <button class="btn-icon">üìä</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- SECTION : MESSAGERIE -->
            <section id="section-messages" class="admin-section">
                <header class="content-header">
                    <div class="header-title">
                        <h1>Centre de Communication</h1>
                        <p>G√©rez vos √©changes avec les classes et les √©l√®ves</p>
                    </div>
                </header>
                
                <div style="display: flex; gap: 20px; height: calc(100vh - 200px);">
                    <!-- Liste des conversations -->
                    <div class="stats-card" style="flex: 1; display: flex; flex-direction: column; padding: 0; overflow: hidden;">
                        <div style="padding: 15px; border-bottom: 1px solid #eee; background: #f8f9fa;">
                            <input type="text" placeholder="Rechercher une discussion..." style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ddd;">
                        </div>
                        
                        <div style="overflow-y: auto; flex-grow: 1;" id="conversation-list">
                            <!-- Classe 6√®me A -->
                            <div style="border-bottom: 1px solid #eee;" id="conv-group-6A">
                                <div onclick="selectChat('6√®me A', 'classe', 'G√©n√©ral')" style="padding: 12px 15px; background: #f8f9fa; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: bold; border-left: 4px solid #3498db;">
                                    <span>üì¢ 6√®me A - G√©n√©ral</span>
                                    <span class="status-pill" style="background: #3498db; color: white; padding: 2px 6px; font-size: 0.7rem;">2</span>
                                </div>
                                
                                <!-- Th√®me : Fractions -->
                                <div style="padding: 5px 15px; background: #f0f4f8; font-size: 0.8rem; font-weight: bold; color: #2c3e50; display: flex; align-items: center; gap: 5px;">
                                    üìò Th√®me : Les Fractions
                                </div>
                                <div style="background: #fff; padding-left: 15px;">
                                    <div class="msg-item" onclick="selectChat('6√®me A', 'classe', 'Les Fractions')" style="padding: 8px 15px; border-bottom: 1px solid #f0f0f0; cursor: pointer; font-size: 0.85rem; color: #34495e;">
                                        üì¢ Chat de groupe
                                    </div>
                                    <div class="msg-item" onclick="selectChat('Alice MARTIN', 'eleve', 'Les Fractions')" style="padding: 8px 15px; border-bottom: 1px solid #f0f0f0; cursor: pointer; font-size: 0.85rem; display: flex; justify-content: space-between;">
                                        <span>üë§ Alice MARTIN</span>
                                        <span class="status-pill" style="background: #e74c3c; color: white; padding: 1px 5px; font-size: 0.6rem; border-radius: 10px;">1</span>
                                    </div>
                                    <div class="msg-item" onclick="selectChat('Thomas DUBOIS', 'eleve', 'Les Fractions')" style="padding: 8px 15px; border-bottom: 1px solid #f0f0f0; cursor: pointer; font-size: 0.85rem;">
                                        <span>üë§ Thomas DUBOIS</span>
                                    </div>
                                </div>

                                <!-- Th√®me : G√©om√©trie -->
                                <div style="padding: 5px 15px; background: #f0f4f8; font-size: 0.8rem; font-weight: bold; color: #2c3e50;">
                                    üìò Th√®me : G√©om√©trie
                                </div>
                                <div style="background: #fff; padding-left: 15px;">
                                    <div class="msg-item" onclick="selectChat('6√®me A', 'classe', 'G√©om√©trie')" style="padding: 8px 15px; border-bottom: 1px solid #f0f0f0; cursor: pointer; font-size: 0.85rem; color: #34495e;">
                                        üì¢ Chat de groupe
                                    </div>
                                </div>
                            </div>

                            <!-- Classe 3√®me B -->
                            <div style="border-bottom: 1px solid #eee;">
                                <div onclick="selectChat('3√®me B', 'classe', 'G√©n√©ral')" style="padding: 12px 15px; background: #f8f9fa; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: bold; border-left: 4px solid #95a5a6;">
                                    <span>üì¢ 3√®me B - G√©n√©ral</span>
                                </div>
                                <div style="padding: 5px 15px; background: #f0f4f8; font-size: 0.8rem; font-weight: bold; color: #2c3e50;">
                                    üìò Th√®me : Alg√®bre
                                </div>
                                <div style="background: #fff; padding-left: 15px;">
                                    <div class="msg-item" onclick="selectChat('Zoe BERNARD', 'eleve', 'Alg√®bre')" style="padding: 8px 15px; border-bottom: 1px solid #f0f0f0; cursor: pointer; font-size: 0.85rem;">
                                        <span>üë§ Zoe BERNARD</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Fen√™tre de Chat -->
                    <div class="stats-card" style="flex: 2.5; display: flex; flex-direction: column; padding: 0; overflow: hidden;">
                        <!-- Header du Chat -->
                        <div id="chat-header" style="padding: 15px; border-bottom: 1px solid #eee; background: #fff; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 id="chat-target-name" style="margin: 0;">üì¢ Classe : 6√®me A</h3>
                                <span id="chat-target-status" style="font-size: 0.8rem; color: #2ecc71;">‚óè Discussion de groupe active</span>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn-icon" title="Param√®tres du chat">‚öôÔ∏è</button>
                                <button class="btn-icon" title="Voir les membres">üë•</button>
                            </div>
                        </div>

                        <!-- Zone des messages -->
                        <div id="main-chat-messages" style="flex-grow: 1; overflow-y: auto; padding: 20px; background: #f4f7f6; display: flex; flex-direction: column; gap: 15px;">
                            <div class="message bot" style="align-self: flex-end; background: #3498db; color: white; padding: 10px 15px; border-radius: 15px 15px 0 15px; max-width: 70%;">
                                <strong>M. DUPONT :</strong> Bonjour √† tous ! N'oubliez pas de terminer le quiz sur les fractions avant demain soir.
                            </div>
                            <div class="message user" style="align-self: flex-start; background: white; color: #2c3e50; padding: 10px 15px; border-radius: 15px 15px 15px 0; max-width: 70%; border: 1px solid #ddd;">
                                <strong>Alice MARTIN :</strong> Merci Monsieur, c'est not√© !
                            </div>
                            <div class="message user" style="align-self: flex-start; background: white; color: #2c3e50; padding: 10px 15px; border-radius: 15px 15px 15px 0; max-width: 70%; border: 1px solid #ddd;">
                                <strong>Thomas DUBOIS :</strong> Est-ce qu'on peut utiliser la calculatrice ?
                            </div>
                        </div>

                        <!-- Input du Chat -->
                        <div style="padding: 15px; background: #fff; border-top: 1px solid #eee;">
                            <div class="chat-input" style="display: flex; gap: 10px; align-items: center;">
                                <input type="file" id="main-chat-file-input" style="display: none;" onchange="handleMainFileUpload(this)">
                                <button type="button" onclick="document.getElementById('main-chat-file-input').click()" style="background: #95a5a6; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer;" title="Joindre un fichier">üìé</button>
                                <input type="text" id="main-chat-input-text" placeholder="√âcrire un message..." style="flex-grow: 1; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                                <button onclick="sendMainChatMessage()" style="background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: bold;">Envoyer ‚û§</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION : PLANNING -->
            <section id="section-planning" class="admin-section">
                <header class="content-header">
                    <div class="header-title">
                        <h1>Planning & Agenda</h1>
                        <p>G√©rez l'emploi du temps de vos classes et √©l√®ves.</p>
                    </div>
                    <div class="header-actions" style="display: flex; gap: 10px;">
                        <select id="planning-filter-class" class="search-filter" onchange="updatePlanningView()">
                            <option value="all">Toutes les classes</option>
                            <option value="6A">6√®me A</option>
                            <option value="3B">3√®me B</option>
                        </select>
                        <select id="planning-filter-student" class="search-filter" onchange="updatePlanningView()">
                            <option value="all">Tous les √©l√®ves</option>
                            <!-- Sera rempli dynamiquement -->
                        </select>
                        <button class="btn-primary" onclick="openTeacherCalendarModal()">+ Nouvel √âv√©nement</button>
                    </div>
                </header>

                <div class="calendar-container" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                    <div class="calendar-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <button class="btn-icon" onclick="changeMonth(-1)">‚óÄ</button>
                        <h2 id="calendar-month-year" style="margin: 0; color: #2c3e50;">D√©cembre 2025</h2>
                        <button class="btn-icon" onclick="changeMonth(1)">‚ñ∂</button>
                    </div>
                    
                    <div id="calendar-grid" class="calendar-grid">
                        <div class="calendar-day-header">Lun</div>
                        <div class="calendar-day-header">Mar</div>
                        <div class="calendar-day-header">Mer</div>
                        <div class="calendar-day-header">Jeu</div>
                        <div class="calendar-day-header">Ven</div>
                        <div class="calendar-day-header">Sam</div>
                        <div class="calendar-day-header">Dim</div>
                        <!-- Les jours seront g√©n√©r√©s par JS -->
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- MODAL : D√âTAILS DE LA CLASSE -->
    <div id="modal-classe-details" class="wireframe-modal">
        <div class="modal-content" style="width: 900px; max-width: 95%;">
            <div class="modal-header">
                <h3 id="modal-classe-title">D√©tails de la Classe : 6√®me A</h3>
                <button class="close-modal">&times;</button>
            </div>

            <!-- Onglets de navigation interne au modal Classe -->
            <div style="display: flex; background: #f8f9fa; border-bottom: 1px solid #ddd;">
                <button class="tab-btn-classe active" onclick="switchClasseTab('suivi')" style="padding: 12px 20px; border: none; background: none; cursor: pointer; font-weight: bold; border-bottom: 2px solid #3498db;">Suivi P√©dagogique</button>
                <button class="tab-btn-classe" onclick="switchClasseTab('chat')" style="padding: 12px 20px; border: none; background: none; cursor: pointer; font-weight: bold;">Chat de Classe</button>
            </div>

            <div class="modal-body">
                <!-- TAB : SUIVI P√âDAGOGIQUE -->
                <div id="classe-tab-suivi" class="classe-tab-content">
                    <!-- Filtres d'analyse rapide -->
                    <div class="filter-bar" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                            <span style="font-weight: bold; font-size: 0.9rem;">Analyser par :</span>
                            <select id="filter-analyse-type">
                                <option value="global">Vue Globale</option>
                                <option value="exercices">R√©sultats Exercices</option>
                                <option value="ia-interactions">Interactions IA</option>
                                <option value="assiduite">Assiduit√© / Connexion</option>
                            </select>
                            <input type="text" placeholder="Rechercher un √©l√®ve dans cette classe..." class="search-filter" style="width: 300px;">
                        </div>
                    </div>

                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>√âl√®ve</th>
                                    <th>Moyenne</th>
                                    <th>Dernier Exercice</th>
                                    <th>Score IA</th>
                                    <th>Alerte</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="table-classe-eleves">
                                <!-- Rempli dynamiquement -->
                                <tr>
                                    <td>Alice MARTIN</td>
                                    <td>15.5/20</td>
                                    <td>Les Fractions (A+)</td>
                                    <td><span class="tag">Excellent</span></td>
                                    <td><span class="status-pill" style="background: #e8f5e9; color: #2e7d32;">RAS</span></td>
                                    <td><button class="btn-small" onclick="openEleveDetails('Alice MARTIN')">Actions</button></td>
                                </tr>
                                <tr>
                                    <td>Thomas DUBOIS</td>
                                    <td>09.5/20</td>
                                    <td>Les Fractions (C-)</td>
                                    <td><span class="tag" style="background: #fff3e0; color: #ef6c00;">Besoin d'aide</span></td>
                                    <td><span class="status-pill" style="background: #ffebee; color: #c62828;">D√©crochage</span></td>
                                    <td><button class="btn-small" onclick="openEleveDetails('Thomas DUBOIS')">Actions</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Zone de KPI sp√©cifiques (Propositions) -->
                    <div class="stats-grid" style="margin-top: 20px;">
                        <div class="stats-card" style="background: #f0f7ff;">
                            <h3>Point Fort Classe</h3>
                            <p>Participation aux exercices IA</p>
                            <div class="stats-value">92%</div>
                        </div>
                        <div class="stats-card" style="background: #fff5f5;">
                            <h3>Point de Vigilance</h3>
                            <p>Compr√©hension des √©nonc√©s complexes</p>
                            <div class="stats-value" style="color: #e74c3c;">-15%</div>
                        </div>
                    </div>
                </div>

                <!-- TAB : CHAT DE CLASSE -->
                <div id="classe-tab-chat" class="classe-tab-content" style="display: none;">
                    <div class="stats-card" style="border: 1px solid #3498db; background: #f0f7ff; margin-bottom: 15px;">
                        <p style="margin: 0; font-size: 0.9rem;"><strong>Note :</strong> Ce message sera visible par tous les √©l√®ves de la classe <strong>6√®me A</strong> pour le cours de <strong>Math√©matiques</strong>.</p>
                    </div>
                    <div class="chat-container" style="height: 350px;">
                        <div class="chat-messages" id="class-chat-messages">
                            <div class="message bot" style="background: #34495e; color: white;">
                                <strong>M. DUPONT :</strong> Bonjour √† tous ! N'oubliez pas de terminer le quiz sur les fractions avant demain soir.
                            </div>
                            <div class="message user" style="background: #ecf0f1; color: #2c3e50;">
                                <strong>Alice MARTIN :</strong> Merci Monsieur, c'est not√© !
                            </div>
                        </div>
                        <div class="chat-input">
                            <input type="file" id="class-chat-file-input" style="display: none;" onchange="handleClassFileUpload(this)">
                            <button type="button" onclick="document.getElementById('class-chat-file-input').click()" style="background: #95a5a6; margin-right: 5px;" title="Joindre un fichier">üìé</button>
                            <input type="text" id="class-chat-input-text" placeholder="Envoyer un message √† toute la classe..." style="flex-grow: 1;">
                            <button onclick="sendClassChatMessage()">‚û§</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal">Fermer</button>
                <button class="btn-primary">Exporter le rapport</button>
            </div>
        </div>
    </div>

    <!-- MODAL : D√âTAILS INDIVIDUELS √âL√àVE -->
    <div id="modal-eleve-details" class="wireframe-modal" style="z-index: 1100;">
        <div class="modal-content" style="width: 900px; border: 2px solid #3498db;">
            <div class="modal-header" style="background: #f0f7ff;">
                <div style="display: flex; flex-direction: column;">
                    <h3 id="modal-eleve-name" style="margin: 0;">R√©sultats de l'√©l√®ve : Alice MARTIN</h3>
                    <span style="font-size: 0.75rem; color: #7f8c8d; margin-top: 5px;">üîí Confidentialit√© : Les √©changes priv√©s entre l'√©l√®ve et l'IA ne sont pas consultables.</span>
                </div>
                <button class="close-modal-eleve" style="background:none; border:none; font-size:1.5rem; cursor:pointer;">&times;</button>
            </div>
            
            <!-- Onglets de navigation interne au modal -->
            <div style="display: flex; background: #f8f9fa; border-bottom: 1px solid #ddd;">
                <button class="tab-btn active" onclick="switchEleveTab('results')" style="padding: 12px 20px; border: none; background: none; cursor: pointer; font-weight: bold; border-bottom: 2px solid #3498db;">Parcours & Rem√©diation</button>
                <button class="tab-btn" onclick="switchEleveTab('benchmarks')" style="padding: 12px 20px; border: none; background: none; cursor: pointer; font-weight: bold;">Benchmarks & Stats</button>
                <button class="tab-btn" onclick="switchEleveTab('chat')" style="padding: 12px 20px; border: none; background: none; cursor: pointer; font-weight: bold;">Messagerie Directe</button>
            </div>

            <div class="modal-body">
                <!-- TAB : R√âSULTATS -->
                <div id="eleve-tab-results" class="eleve-tab-content">
                    <div class="filter-bar">
                        <select id="filter-eleve-cours">
                            <option value="">Tous les cours</option>
                            <option value="fractions">Les Fractions</option>
                            <option value="algebre">Alg√®bre</option>
                        </select>
                        <select id="filter-eleve-periode">
                            <option value="30">30 derniers jours</option>
                            <option value="all">Ann√©e compl√®te</option>
                        </select>
                    </div>

                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Type</th>
                                    <th>Contenu / Exercice</th>
                                    <th>Score / √âtat</th>
                                    <th>Progression</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="table-eleve-results">
                                <tr>
                                    <td>15/12/2025</td>
                                    <td><span class="tag" style="background:#e1f5fe;">Exercice</span></td>
                                    <td>Les Fractions - Quiz 1</td>
                                    <td>18/20</td>
                                    <td><div class="progress-container"><div class="progress-bar" style="width: 90%;"></div></div></td>
                                    <td><button class="btn-small" onclick="showRemediation('fractions')">Rem√©diation IA</button></td>
                                </tr>
                                <tr>
                                    <td>14/12/2025</td>
                                    <td><span class="tag" style="background:#f3e5f5;">Cours</span></td>
                                    <td>Intro aux Fractions</td>
                                    <td>Lu (100%)</td>
                                    <td><div class="progress-container"><div class="progress-bar" style="width: 100%; background:#2ecc71;"></div></div></td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>10/12/2025</td>
                                    <td><span class="tag" style="background:#e1f5fe;">Exercice</span></td>
                                    <td>Calcul Mental - Niveau 2</td>
                                    <td>14/20</td>
                                    <td><div class="progress-container"><div class="progress-bar" style="width: 70%;"></div></div></td>
                                    <td><button class="btn-small" onclick="showRemediation('calcul')">Rem√©diation IA</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Zone d'affichage de la rem√©diation sp√©cifique (cach√©e par d√©faut) -->
                    <div id="remediation-box" class="stats-card" style="display: none; margin-top: 15px; border: 1px solid #3498db; background: #f0f7ff;">
                        <h4 id="remediation-title" style="margin-top: 0; color: #2980b9;">Rem√©diation : Les Fractions</h4>
                        <div id="remediation-content" style="font-size: 0.9rem;">
                            <!-- Contenu dynamique -->
                        </div>
                    </div>

                    <!-- Bloc d'orientation p√©dagogique GLOBAL -->
                    <div class="stats-card" style="margin-top: 20px; border-left: 4px solid #3498db; background: #f9f9f9;">
                        <h3><span class="ai-badge">Plan d'Action Global</span></h3>
                        <p style="font-size: 0.9rem; line-height: 1.5; color: #2c3e50;">
                            <strong>Synth√®se comportementale :</strong> L'√©l√®ve progresse bien mais montre une fatigue cognitive apr√®s 20 min d'exercice. <br>
                            <strong>Conseil :</strong> Fractionner les sessions de travail en blocs de 15 min.
                        </p>
                    </div>
                </div>

                <!-- TAB : BENCHMARKS -->
                <div id="eleve-tab-benchmarks" class="eleve-tab-content" style="display: none;">
                    <h3>Comparaison avec la classe</h3>
                    <div class="stats-grid">
                        <div class="stats-card">
                            <h3>Moyenne √âl√®ve</h3>
                            <div class="stats-value">15.5</div>
                            <div class="performance-bar-container"><div class="performance-bar" style="width: 77%; background: #3498db;"></div></div>
                        </div>
                        <div class="stats-card">
                            <h3>Moyenne Classe</h3>
                            <div class="stats-value">13.2</div>
                            <div class="performance-bar-container"><div class="performance-bar" style="width: 66%; background: #95a5a6;"></div></div>
                        </div>
                        <div class="stats-card">
                            <h3>Top 10%</h3>
                            <div class="stats-value">18.5</div>
                            <div class="performance-bar-container"><div class="performance-bar" style="width: 92%; background: #2ecc71;"></div></div>
                        </div>
                    </div>
                </div>

                <!-- TAB : CHAT -->
                <div id="eleve-tab-chat" class="eleve-tab-content" style="display: none;">
                    <div class="chat-container" style="height: 300px;">
                        <div class="chat-messages">
                            <div class="message bot">Bonjour Alice, j'ai vu tes r√©sultats sur les fractions. C'est tr√®s bien ! As-tu besoin d'aide sur un point pr√©cis ?</div>
                            <div class="message user">Merci Monsieur ! Je bloque un peu sur la simplification.</div>
                        </div>
                        <div class="chat-input">
                            <input type="file" id="chat-file-input" style="display: none;" onchange="handleFileUpload(this)">
                            <button type="button" onclick="document.getElementById('chat-file-input').click()" style="background: #95a5a6; margin-right: 5px;" title="Joindre un fichier">üìé</button>
                            <input type="text" placeholder="Envoyez un message √† l'√©l√®ve...">
                            <button>‚û§</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal-eleve">Fermer</button>
                <button class="btn-primary" style="background-color: #2c3e50;">G√©n√©rer Plan d'Action Global</button>
            </div>
        </div>
    </div>

    <!-- MODAL : NOUVEAU DOSSIER -->
    <div id="modal-new-folder" class="wireframe-modal">
        <div class="modal-content" style="width: 400px;">
            <div class="modal-header">
                <h3>Cr√©er un nouveau dossier</h3>
                <button class="close-modal-folder" style="background:none; border:none; font-size:1.5rem; cursor:pointer;">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Nom du dossier</label>
                    <input type="text" id="new-folder-name" placeholder="Ex: Chapitre 2 : Alg√®bre">
                </div>
                <div class="form-group">
                    <label>Dossier parent</label>
                    <select id="new-folder-parent">
                        <option value="main-tree-view">Racine</option>
                        <option value="root-maths-6">Math√©matiques - 6√®me</option>
                        <option value="root-maths-3">Math√©matiques - 3√®me</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal-folder">Annuler</button>
                <button class="btn-primary" onclick="confirmNewFolder()">Cr√©er le dossier</button>
            </div>
        </div>
    </div>

    <!-- MODAL : CHARGER UN DOCUMENT -->
    <div id="modal-upload" class="wireframe-modal">
        <div class="modal-content" style="width: 500px;">
            <div class="modal-header">
                <h3>Charger un document</h3>
                <button class="close-modal-upload" style="background:none; border:none; font-size:1.5rem; cursor:pointer;">&times;</button>
            </div>
            <div class="modal-body">
                <div style="border: 2px dashed #3498db; padding: 30px; text-align: center; border-radius: 8px; background: #f0f7ff; margin-bottom: 20px; cursor: pointer;" onclick="document.getElementById('file-upload-input').click()">
                    <span style="font-size: 2rem;">üìÑ</span>
                    <p style="margin-top: 10px; font-weight: bold;">Cliquez ou glissez un fichier ici</p>
                    <p style="font-size: 0.8rem; color: #7f8c8d;">PDF, DOCX, PPTX ou Images (Max 20Mo)</p>
                    <input type="file" id="file-upload-input" style="display: none;" onchange="handleFileSelection(this)">
                </div>
                <div id="selected-file-info" style="display: none; background: #f8f9fa; padding: 10px; border-radius: 4px; margin-bottom: 15px; border: 1px solid #eee;">
                    <strong>Fichier s√©lectionn√© :</strong> <span id="selected-file-name">nom_du_fichier.pdf</span>
                </div>
                <div class="form-group">
                    <label>Dossier de destination</label>
                    <select id="upload-dest-folder">
                        <option value="root-maths-6">Math√©matiques - 6√®me</option>
                        <option value="chap1-fractions">Chapitre 1 : Fractions</option>
                    </select>
                </div>
                <div class="stats-card" style="background: #fff9c4; border: none; padding: 10px;">
                    <p style="margin: 0; font-size: 0.85rem;">üí° <strong>Analyse IA :</strong> Une fois charg√©, l'IA lira le contenu pour aider vos √©l√®ves lors des sessions de tutorat.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal-upload">Annuler</button>
                <button class="btn-primary" onclick="confirmUpload()">Lancer le chargement</button>
            </div>
        </div>
    </div>

    <!-- MODAL : ATTRIBUTION DE CONTENU -->
    <div id="modal-attribution" class="wireframe-modal">
        <div class="modal-content" style="width: 500px;">
            <div class="modal-header">
                <h3>Attribuer le contenu</h3>
                <button class="close-modal-attr" style="background:none; border:none; font-size:1.5rem; cursor:pointer;">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Contenu √† attribuer</label>
                    <div id="attr-tree-container" style="border: 1px solid #ddd; border-radius: 4px; max-height: 200px; overflow-y: auto; padding: 10px; background: #fff;">
                        <div class="tree-view" id="attr-tree-view">
                            <!-- Arborescence identique √† "Mes Cours" -->
                            <div class="tree-item folder open">
                                <span class="tree-toggle">‚ñº</span> üìÅ <strong>Math√©matiques - 6√®me</strong>
                                <div class="tree-children">
                                    <div class="tree-item folder">
                                        <span class="tree-toggle">‚ñ∂</span> üìÅ Chapitre 1 : Fractions
                                        <div class="tree-children" style="display: none;">
                                            <div class="tree-item file" onclick="selectAttrContent(this, 'Les fractions - Intro')">üìÑ Intro.pdf</div>
                                            <div class="tree-item file" onclick="selectAttrContent(this, 'Quiz Fractions')">üìù Quiz_Niveau1.ia</div>
                                        </div>
                                    </div>
                                    <div class="tree-item file" onclick="selectAttrContent(this, 'G√©om√©trie de base')">üìÑ G√©om√©trie_Base.pdf</div>
                                </div>
                            </div>
                            <div class="tree-item folder">
                                <span class="tree-toggle">‚ñ∂</span> üìÅ <strong>Math√©matiques - 3√®me</strong>
                                <div class="tree-children" style="display: none;">
                                    <div class="tree-item file" onclick="selectAttrContent(this, 'Analyse de texte - Moli√®re')">üìÑ Moliere_Analyse.pdf</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <input type="hidden" id="attr-content-selected-value">
                </div>
                
                <div class="form-group">
                    <label>Type d'attribution</label>
                    <select id="attr-type" onchange="toggleAttrTarget()">
                        <option value="classe">√Ä une classe enti√®re</option>
                        <option value="eleve">√Ä un √©l√®ve sp√©cifique</option>
                    </select>
                </div>

                <div id="attr-target-classe" class="form-group">
                    <label>Choisir la classe</label>
                    <select id="attr-classe">
                        <option>6√®me A</option>
                        <option>3√®me B</option>
                    </select>
                </div>

                <div id="attr-target-eleve" class="form-group" style="display: none;">
                    <label>Choisir l'√©l√®ve</label>
                    <select id="attr-eleve">
                        <option>Alice MARTIN</option>
                        <option>Thomas DUBOIS</option>
                        <option>Zoe BERNARD</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Date d'√©ch√©ance (optionnel)</label>
                    <input type="date" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ddd;">
                </div>

                <div class="form-group">
                    <label>Instructions sp√©cifiques pour l'IA</label>
                    <textarea placeholder="Ex: L'IA doit √™tre plus indulgente sur ce devoir..." style="width: 100%; height: 60px; padding: 8px; border-radius: 4px; border: 1px solid #ddd;"></textarea>
                </div>

                <div class="form-group">
                    <label>Options</label>
                    <div class="checkbox-item">
                        <input type="checkbox" checked> Imm√©diatement disponible
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox"> Notifier par message
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal-attr">Annuler</button>
                <button class="btn-primary" onclick="confirmAttribution()">Confirmer l'attribution</button>
            </div>
        </div>
    </div>

    <!-- Modal Cr√©ation √âv√©nement Professeur -->
    <div id="teacher-calendar-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 600px; max-height: 90vh; overflow-y: auto; animation: slideIn 0.3s ease-out;">
            <h3 style="margin-bottom: 20px; color: #2c3e50;">üìÖ Planifier un Cours / Devoir</h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                <div>
                    <label style="display: block; font-size: 0.8rem; font-weight: bold; color: #7f8c8d; margin-bottom: 5px;">Classe Cible</label>
                    <select id="event-target-class" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                        <option value="">-- S√©lectionner une classe --</option>
                        <option value="6A">6√®me A</option>
                        <option value="3B">3√®me B</option>
                    </select>
                </div>
                <div>
                    <label style="display: block; font-size: 0.8rem; font-weight: bold; color: #7f8c8d; margin-bottom: 5px;">√âl√®ves (Cocher pour s√©lectionner)</label>
                    <div id="event-target-students-container" style="width: 100%; height: 100px; overflow-y: auto; padding: 10px; border: 1px solid #ddd; border-radius: 6px; background: #f9f9f9;">
                        <div style="color: #95a5a6; font-size: 0.8rem; font-style: italic;">S√©lectionnez une classe d'abord</div>
                    </div>
                </div>
            </div>

            <div style="margin-bottom: 15px;">
                <label style="display: block; font-size: 0.8rem; font-weight: bold; color: #7f8c8d; margin-bottom: 5px;">Mati√®re</label>
                <select id="event-subject" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                    <option value="">-- S√©lectionner une mati√®re --</option>
                    <option value="Maths">Math√©matiques</option>
                    <option value="Histoire">Histoire-G√©o</option>
                    <option value="Francais">Fran√ßais</option>
                    <option value="Physique">Physique-Chimie</option>
                </select>
            </div>

            <div style="margin-bottom: 15px;">
                <label style="display: block; font-size: 0.8rem; font-weight: bold; color: #7f8c8d; margin-bottom: 5px;">Contenu du cours / devoir</label>
                <select id="event-content-select" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                    <option value="">-- S√©lectionner un contenu --</option>
                </select>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                <div>
                    <label style="display: block; font-size: 0.8rem; font-weight: bold; color: #7f8c8d; margin-bottom: 5px;">Date d√©but</label>
                    <input type="date" id="event-start-date" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                </div>
                <div>
                    <label style="display: block; font-size: 0.8rem; font-weight: bold; color: #7f8c8d; margin-bottom: 5px;">Heure d√©but</label>
                    <input type="time" id="event-start-time" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                <div>
                    <label style="display: block; font-size: 0.8rem; font-weight: bold; color: #7f8c8d; margin-bottom: 5px;">Date fin</label>
                    <input type="date" id="event-end-date" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                </div>
                <div>
                    <label style="display: block; font-size: 0.8rem; font-weight: bold; color: #7f8c8d; margin-bottom: 5px;">Heure fin</label>
                    <input type="time" id="event-end-time" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                </div>
            </div>

            <div style="margin-bottom: 15px;">
                <label style="display: block; font-size: 0.8rem; font-weight: bold; color: #7f8c8d; margin-bottom: 5px;">Contenu / Description</label>
                <textarea id="event-desc" rows="3" placeholder="D√©tails du cours, consignes..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; resize: none;"></textarea>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; font-size: 0.8rem; font-weight: bold; color: #7f8c8d; margin-bottom: 5px;">Pi√®ces jointes (Simulation)</label>
                <div style="border: 2px dashed #ddd; padding: 15px; text-align: center; border-radius: 6px; color: #95a5a6; cursor: pointer;" onclick="alert('Ouverture explorateur de fichiers...')">
                    üìé Glisser-d√©poser ou cliquer pour ajouter des documents
                </div>
            </div>

            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button class="btn-secondary" onclick="closeTeacherCalendarModal()">Annuler</button>
                <button class="btn-primary" onclick="saveTeacherEvent()">Publier l'√©v√©nement</button>
            </div>
        </div>
    </div>

    <!-- Modal Cr√©ation de Cours Directe -->
    <div id="modal-create-course" class="modal-overlay" style="display: none;">
        <div class="modal-content modal-large">
            <h3 class="modal-title">üìù Cr√©er un nouveau cours</h3>
            
            <div class="form-group">
                <label class="form-label">Titre du cours</label>
                <input type="text" id="create-course-title" placeholder="Ex: Les nombres relatifs - Chapitre 1" class="form-input">
            </div>

            <div class="form-group">
                <label class="form-label">Contenu du cours</label>
                <div class="editor-container">
                    <!-- Toolbar Simulation -->
                    <div class="editor-toolbar">
                        <button class="btn-icon" title="Gras"><b>B</b></button>
                        <button class="btn-icon" title="Italique"><i>I</i></button>
                        <button class="btn-icon" title="Soulign√©"><u>U</u></button>
                        <div class="separator-vertical"></div>
                        <button class="btn-icon" title="Ajouter une image" onclick="alert('Simulation: Image ajout√©e')">üñºÔ∏è Image</button>
                        <button class="btn-icon" title="Ajouter un lien">üîó Lien</button>
                        <div class="separator-vertical"></div>
                        <button class="btn-icon" style="color: #8e44ad; font-weight: bold;" onclick="openAiImproveModal()">‚ú® Am√©liorer avec l'IA</button>
                    </div>
                    <textarea id="create-course-content" class="editor-content" placeholder="R√©digez votre cours ici... Vous pouvez structurer le texte, ajouter des d√©finitions, des exemples..."></textarea>
                </div>
            </div>

            <div class="ai-config-box">
                <h4 class="ai-config-header">
                    ‚ú® Configuration IA
                    <span class="ai-badge">G√©n√©ration automatique</span>
                </h4>
                <p style="font-size: 0.9rem; color: #546e7a; margin-bottom: 15px;">S√©lectionnez les types d'exercices que l'IA pourra g√©n√©rer √† partir de ce cours :</p>
                
                <div class="ai-grid-checkboxes">
                    <label class="checkbox-card">
                        <input type="checkbox" checked> Quiz (QCM)
                    </label>
                    <label class="checkbox-card">
                        <input type="checkbox" checked> √âtude de cas
                    </label>
                    <label class="checkbox-card">
                        <input type="checkbox" checked> Analyse de texte
                    </label>
                    <label class="checkbox-card">
                        <input type="checkbox"> R√©sum√© automatique
                    </label>
                    <label class="checkbox-card">
                        <input type="checkbox"> Flashcards
                    </label>
                    <label class="checkbox-card">
                        <input type="checkbox"> D√©finitions
                    </label>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeCreateCourseModal()">Annuler</button>
                <button class="btn-primary" onclick="saveCreatedCourse()">Enregistrer le cours</button>
            </div>
        </div>
    </div>

    <!-- Modal Am√©lioration IA -->
    <div id="modal-ai-improve" class="modal-overlay" style="display: none; z-index: 2000;">
        <div class="modal-content modal-xl">
            <h3 class="modal-title-ai">
                ‚ú® Assistant P√©dagogique IA
            </h3>
            
            <div class="split-view-2col">
                <!-- Colonne Gauche : Prompt et Original -->
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <div>
                        <label class="form-label">Votre demande √† l'IA (Prompt)</label>
                        <textarea id="ai-improve-prompt" rows="4" class="ai-prompt-area" placeholder="Ex: Rends ce texte plus accessible pour des √©l√®ves de 6√®me, ajoute des exemples concrets et structure le contenu avec des titres clairs."></textarea>
                    </div>
                    <div>
                        <label class="form-label">Contenu actuel</label>
                        <div id="ai-improve-original" class="ai-original-view">
                            <!-- Contenu original inject√© ici -->
                        </div>
                    </div>
                </div>

                <!-- Colonne Droite : R√©sultat -->
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <label class="form-label" style="color: #27ae60;">Proposition de l'IA</label>
                        <button class="btn-primary" style="background: #8e44ad; font-size: 0.8rem; padding: 5px 10px;" onclick="runAiImprovement()">üöÄ G√©n√©rer / Am√©liorer</button>
                    </div>
                    <div class="ai-result-container">
                        <textarea id="ai-improve-result" class="ai-result-textarea" placeholder="Le r√©sultat g√©n√©r√© par l'IA appara√Ætra ici..."></textarea>
                        <div id="ai-loading" class="ai-loading-overlay">
                            <div class="spinner" style="border-top-color: #8e44ad;"></div>
                            <p style="color: #8e44ad; font-weight: bold; margin-top: 10px;">L'IA r√©fl√©chit...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeAiImproveModal()">Annuler</button>
                <button class="btn-primary" style="background: #27ae60;" onclick="applyAiChanges()">‚úÖ Valider et Remplacer</button>
            </div>
        </div>
    </div>

    <!-- Script Legacy - Utilis√© temporairement car Simple Browser VS Code ne supporte pas bien les modules ES6 -->
    <script src="teacher.js"></script>
    
    <!-- Modules ES6 Refactoris√©s (comment√©s pour compatibilit√© Simple Browser)
    <script type="module">
        (async () => {
            try {
                await import('./js/teacher.refactored.js');
                console.log('Teacher module loaded successfully');
            } catch (e) {
                console.error('Failed to load teacher module:', e);
            }
        })();
    </script>
    -->
</body>
</html>
